<%-include("layout/header") %>

      <div class="container-fluid">
      <div class="page-header text-center">
        <div class="">
            <h1><%=user.firstName %></h1>
            
        </div>

          <a href="/feed" class="btn btn-default btn-sm" style="color: #709085;" >Feed</a>
          <a href="/findTherapists" class="btn btn-default btn-sm" style="color: #709085;">Find Therapists</a>
          <a href="/logout" class="btn btn-default btn-sm" style="color: #709085;">Logout</a>
      </div>

      <center>

      <!-- <div class="card h-100 shadow">
        <div class="uploads row row-cols-1 row-cols-md-3 g-4">-->

        <br>
          <form action= "/upload" method="post" enctype="multipart/form-data">
            <div class="row">
              <div class="row gram-card-content">
                <div class="gram-card-image">
                  <center>
                     <div class="upload-btn-wrapper">
                       <input class="form-control-file" type="file" name="file-to-upload">

                    </div>
                    <div id="video-priview">  </div>
                    <img src="" id="blah" class="img-responsive">
                  </center>
                </div>
                  <!-- <p><a class="gram-card-content-user" href="/u/<%= user %>"><%= user.local.email %></a><br> -->

                      <div class="input-field">
                          <input type="text" id="title" class="form-control" name="title">
                              <label for="title">Title</label>
                        </div>

                          <br>



      </div>
          <div class="input-field md-form amber-textarea active-amber-textarea">
              <i class="fas fa-angle-double-right prefix">Ask a Therapist:</i>
              <textarea id="body" name="body" class="md-textarea form-control" ></textarea>

          </div>
      </div>
      <div class=" ">
          <input type="submit" value="Save" class="class="btn btn-default btn-sm"">

      </div>
  </div>

  </form>

  <br>

  <!-- </div>

      </div> -->

     <section class="container">
        <ul class="messages list-group">
        <% for(var i=0; i<posts.length; i++) {%>
          
          <li class="list-group-item message " id= "clickedPost">
           


            <h4 class="mb-1"><%= posts[i].title %></h4>

						<p class="mb-1"><%= posts[i].body %></p>
            <img class="img" style="width:100%" src="data:image/png;base64,<%=posts[i].img.toString('base64') %>" alt="">

            
            <ul class="list-group">    

      <div class="collapsable-comment">
        <div class="d-flex flex-row justify-content-between align-items-center action-collapse p-2" data-bs-toggle="collapse" aria-expanded="false" aria-controls= `collapse-${i}` href=`#collapse-${i}`><span>Comments</span><i class="fa fa-chevron-down servicedrop"></i></div>
          <div id=`collapse-${i}` class=" collapse" style="max-height: 250px; overflow: scroll; ">
      
              <%const commentsForPost = comments.filter(c => c.postId.equals(posts[i]._id)) 
              let start = commentsForPost.length - 5 
              if(start <= 0){
                start = 0
              }

              %>
              <% for (let j = 0; j < commentsForPost.length; ++j) {%> 
          
              
                <li class="list-group-item"><span style="font-size: 12px; color: rgb(141, 58, 58); margin-right: 8px; "><%=commentsForPost[j].commentBy%>:</span><%=commentsForPost[j].comment%></li>
      
             <% } %>
              
           
        </div>
      </div>
    </ul>
            
            <form action="/comment/<%= posts[i]._id %>" method="POST">
              <div class="form-group">
                <label for="exampleInputEmail1" style="font-family: 'Abril Fatface', cursive;">Post Comment</label>
                <input type="text" class="form-control" id="exampleFormControlInput1" placeholder="comment!" name="comment">
              </div>
                <input class="btn btn-primary" type="submit" value="Submit">

            </form>



          </li>

        <% } %>

        </ul>


        </section>






        <!-- <div class="container pt-5"> -->

            <!-- </div> -->

          <!-- </div> -->


</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

   


      </body>
      </html>
